<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<ExecutableTestSuite xmlns="http://www.interactive-instruments.de/etf/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="EID5d449875-1b39-4e34-8f59-b4d3c4045b06" xsi:schemaLocation="http://www.interactive-instruments.de/etf/2.0 ../../schema/model/resultSet.xsd">
  <itemHash>bQ==</itemHash>
  <remoteResource>http://github.com/inspire-eu-validation/ets-repository/metadata/iso</remoteResource>
  <localPath>/auto</localPath>
  <label>Metadatenprofil GDI-NW für die Ressourcenart "Daten"</label>
  <description><![CDATA[Ausgehend von den Basisfestlegungen wurde die spezifische Profilausprägung für die Ressourcenart "Daten" (Datenbestand, Serie, Kachel, Objektart) abgeleitet bzw. die Festlegungen an den Stellen ausgedünnt, an denen die jeweiligen Elemente für diese Ressourcenart nicht vorgesehen sind.]]></description>
  <reference>../../inspire-md-bsxets.xq</reference>
  <version>1.0.0</version>
  <author>Peter Kochmann (Gst. GDI-NW)</author>
  <creationDate>2021-04-06T19:24:17.517Z</creationDate>
  <lastEditor>Peter Kochmann (Gst. GDI-NW)</lastEditor>
  <lastUpdateDate>2022-01-12T09:29:04.466Z</lastUpdateDate>
  <tags>
    <tag ref="EIDfe1f3796-0ebf-4960-a6f7-f935e087fa4c"/>
  </tags>
  <testDriver ref="EID4dddc9e2-1b21-40b7-af70-6a2d156ad130"/>
  <translationTemplateBundle ref="EID70a263c0-0ad7-42f2-9d4d-0d8a4ca71b52"/>
  <ParameterList name="ETF Standard Parameters for XML test objects">
    <parameter name="files_to_test" required="true">
      <defaultValue>.*</defaultValue>
      <allowedValues>.*</allowedValues>
      <type>string</type>
    </parameter>
    <parameter name="tests_to_execute" required="false">
      <defaultValue>.*</defaultValue>
      <allowedValues>.*</allowedValues>
      <type>string</type>
    </parameter>
  </ParameterList>
  <supportedTestObjectTypes>
    <testObjectType ref="EID5a60dded-0cb0-4977-9b06-16c6c2321d2e"/>
  </supportedTestObjectTypes>
  <testModules>
    <TestModule id="EID3820e845-24ed-49ce-9104-4fa4e6c8b3fe">
      <label>MD_SecurityConstraints</label>
      <description><![CDATA[This is a test module]]></description>
      <parent ref="EID5d449875-1b39-4e34-8f59-b4d3c4045b06"/>
      <testCases>
        <TestCase id="EIDa4692c06-be09-4347-a22d-5f8de7992609">
          <label>ISO-Element Nr. 74: Sicherheitseinstufung</label>
          <description><![CDATA[Pflichtelement in Angaben zu Sicherheitseinschränkungen: die Sicherheitseinstufung muss vorhanden sein.]]></description>
          <parent ref="EID3820e845-24ed-49ce-9104-4fa4e6c8b3fe"/>
          <testSteps>
            <TestStep id="EIDbe7ba296-5312-4bd9-a448-4d7d8141b354">
              <label>ISO-Element Nr. 74: Sicherheitseinstufung</label>
              <description><![CDATA[Pflichtelement in Angaben zu Sicherheitseinschränkungen: die Sicherheitseinstufung muss vorhanden sein.]]></description>
              <parent ref="EIDa4692c06-be09-4347-a22d-5f8de7992609"/>
              <statementForExecution>not applicable</statementForExecution>
              <testItemType ref="EIDf483e8e8-06b9-4900-ab36-adad0d7f22f0"/>
              <testAssertions>
                <TestAssertion id="EID67990b0b-5ddd-4bd6-9eac-7faddc22956e">
                  <label>TestAssertion</label>
                  <description><![CDATA[The property with localName 'classification' and namespace 'http://www.isotc211.org/2005/gmd' should have a value that corresponds to one from the following list: <br><ul><li>restricted</li><li>unclassified</li><li>confidential</li><li>secret</li><li>topSecret</li></ul>]]></description>
                  <parent ref="EIDbe7ba296-5312-4bd9-a448-4d7d8141b354"/>
                  <expectedResult>NOT_APPLICABLE</expectedResult>
                  <expression>let $codes := ('restricted', 'unclassified', 'confidential', 'secret', 'topSecret')
let $messages :=
  (for $record in $db
     let $rid := $record//*[local-name()='fileIdentifier' and namespace-uri()='http://www.isotc211.org/2005/gmd']/*/text()
     let $typesFound := $record//*[local-name()='MD_SecurityConstraints' and namespace-uri()='http://www.isotc211.org/2005/gmd']
     for $typeFound in $typesFound
       let $propertyFound := $typeFound/*[local-name()='classification' and namespace-uri()='http://www.isotc211.org/2005/gmd']/*/data(@codeListValue)
       return
         if ($propertyFound and not($propertyFound = $codes)) then
           local:addMessage('TR.invalidPropertyValueError', map { 'localName': 'MD_SecurityConstraints', 'namespace': 'http://www.isotc211.org/2005/gmd', 'fileIdentifier': $rid, 'filename': local:filename($record), 'valueFound': $propertyFound, 'propName': 'classification', 'allowedValues': string-join( $codes, ', ') })
 else ()
  )[position() le $limitErrors]
return
(if ($messages) then 'FAILED' else 'PASSED',
 local:error-statistics('TR.recordsWithErrors', count(fn:distinct-values($messages//etf:argument[@token='id']/text()))),
 $messages)</expression>
                  <testItemType ref="EIDf0edc596-49d2-48d6-a1a1-1ac581dcde0a"/>
                  <translationTemplates>
                    <translationTemplate ref="TR.recordsWithErrors"/>
                    <translationTemplate ref="TR.missingTypeContentError"/>
                    <translationTemplate ref="TR.missingMandatoryTypeError"/>
                    <translationTemplate ref="TR.invalidPropertyCardinalityError"/>
                    <translationTemplate ref="TR.invalidPropertyValueError"/>
                  </translationTemplates>
                </TestAssertion>
              </testAssertions>
            </TestStep>
          </testSteps>
        </TestCase>
        <TestCase id="EIDe99f2235-1403-4b99-aab3-c83d89b8701c">
          <label>ISO-Element Nr. 75: user­Note</label>
          <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
          <parent ref="EID3820e845-24ed-49ce-9104-4fa4e6c8b3fe"/>
          <testSteps>
            <TestStep id="EID6c06f468-431a-4e7a-b3c7-fb4aa623eacd">
              <label>ISO-Element Nr. 75: user­Note</label>
              <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
              <parent ref="EIDe99f2235-1403-4b99-aab3-c83d89b8701c"/>
              <statementForExecution>not applicable</statementForExecution>
              <testItemType ref="EIDf483e8e8-06b9-4900-ab36-adad0d7f22f0"/>
              <testAssertions>
                <TestAssertion id="EIDf0750420-fdbe-4b01-b5cf-441517cb9246">
                  <label>TestAssertion</label>
                  <description><![CDATA[The property with localName 'userNote' and namespace 'http://www.isotc211.org/2005/gmd' should have a minimum cardinality of 0 and a maximum cardinality of 0]]></description>
                  <parent ref="EID6c06f468-431a-4e7a-b3c7-fb4aa623eacd"/>
                  <expectedResult>NOT_APPLICABLE</expectedResult>
                  <expression>let $messages :=
  (for $record in $db
     let $rid := $record//*[local-name()='fileIdentifier' and namespace-uri()='http://www.isotc211.org/2005/gmd']/*/text()
     let $typesFound := $record//*[local-name()='MD_SecurityConstraints' and namespace-uri()='http://www.isotc211.org/2005/gmd']
     for $typeFound in $typesFound 
       let $propertyCount := count($typeFound/*[local-name()='userNote' and namespace-uri()='http://www.isotc211.org/2005/gmd']) 
       return
       if (($propertyCount lt 0) or ($propertyCount gt 0)) then
        local:addMessage('TR.invalidPropertyCardinalityError', map { 'localName': 'MD_SecurityConstraints', 'namespace': 'http://www.isotc211.org/2005/gmd', 'fileIdentifier': $rid, 'filename': local:filename($record), 'invalidCardinality': $propertyCount })
       else ()
  )[position() le $limitErrors]
return
(if ($messages) then 'FAILED' else 'PASSED',
 local:error-statistics('TR.recordsWithErrors', count(fn:distinct-values($messages//etf:argument[@token='id']/text()))),
 $messages)</expression>
                  <testItemType ref="EIDb48eeaa3-6a74-414a-879c-1dc708017e11"/>
                  <translationTemplates>
                    <translationTemplate ref="TR.recordsWithErrors"/>
                    <translationTemplate ref="TR.missingTypeContentError"/>
                    <translationTemplate ref="TR.missingMandatoryTypeError"/>
                    <translationTemplate ref="TR.invalidPropertyCardinalityError"/>
                    <translationTemplate ref="TR.invalidPropertyValueError"/>
                  </translationTemplates>
                </TestAssertion>
              </testAssertions>
            </TestStep>
          </testSteps>
        </TestCase>
        <TestCase id="EIDedc88a75-8fa6-47f8-83bf-4f9da6b005ce">
          <label>ISO-Element Nr. 76: classification­System</label>
          <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
          <parent ref="EID3820e845-24ed-49ce-9104-4fa4e6c8b3fe"/>
          <testSteps>
            <TestStep id="EID845de312-df25-4ce2-87ea-04c278b51837">
              <label>ISO-Element Nr. 76: classification­System</label>
              <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
              <parent ref="EIDedc88a75-8fa6-47f8-83bf-4f9da6b005ce"/>
              <statementForExecution>not applicable</statementForExecution>
              <testItemType ref="EIDf483e8e8-06b9-4900-ab36-adad0d7f22f0"/>
              <testAssertions>
                <TestAssertion id="EID774b0734-f227-4a6f-935d-f71d62830e0a">
                  <label>TestAssertion</label>
                  <description><![CDATA[The property with localName 'classificationSystem' and namespace 'http://www.isotc211.org/2005/gmd' should have a minimum cardinality of 0 and a maximum cardinality of 0]]></description>
                  <parent ref="EID845de312-df25-4ce2-87ea-04c278b51837"/>
                  <expectedResult>NOT_APPLICABLE</expectedResult>
                  <expression>let $messages :=
  (for $record in $db
     let $rid := $record//*[local-name()='fileIdentifier' and namespace-uri()='http://www.isotc211.org/2005/gmd']/*/text()
     let $typesFound := $record//*[local-name()='MD_SecurityConstraints' and namespace-uri()='http://www.isotc211.org/2005/gmd']
     for $typeFound in $typesFound 
       let $propertyCount := count($typeFound/*[local-name()='classificationSystem' and namespace-uri()='http://www.isotc211.org/2005/gmd']) 
       return
       if (($propertyCount lt 0) or ($propertyCount gt 0)) then
        local:addMessage('TR.invalidPropertyCardinalityError', map { 'localName': 'MD_SecurityConstraints', 'namespace': 'http://www.isotc211.org/2005/gmd', 'fileIdentifier': $rid, 'filename': local:filename($record), 'invalidCardinality': $propertyCount })
       else ()
  )[position() le $limitErrors]
return
(if ($messages) then 'FAILED' else 'PASSED',
 local:error-statistics('TR.recordsWithErrors', count(fn:distinct-values($messages//etf:argument[@token='id']/text()))),
 $messages)</expression>
                  <testItemType ref="EIDb48eeaa3-6a74-414a-879c-1dc708017e11"/>
                  <translationTemplates>
                    <translationTemplate ref="TR.recordsWithErrors"/>
                    <translationTemplate ref="TR.missingTypeContentError"/>
                    <translationTemplate ref="TR.missingMandatoryTypeError"/>
                    <translationTemplate ref="TR.invalidPropertyCardinalityError"/>
                    <translationTemplate ref="TR.invalidPropertyValueError"/>
                  </translationTemplates>
                </TestAssertion>
              </testAssertions>
            </TestStep>
          </testSteps>
        </TestCase>
        <TestCase id="EID852d9d94-29eb-4b35-9b4e-1dfdf37d73b6">
          <label>ISO-Element Nr. 77: handling­Description</label>
          <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
          <parent ref="EID3820e845-24ed-49ce-9104-4fa4e6c8b3fe"/>
          <testSteps>
            <TestStep id="EID40a36d49-dacc-488a-86fd-f025bcd07108">
              <label>ISO-Element Nr. 77: handling­Description</label>
              <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
              <parent ref="EID852d9d94-29eb-4b35-9b4e-1dfdf37d73b6"/>
              <statementForExecution>not applicable</statementForExecution>
              <testItemType ref="EIDf483e8e8-06b9-4900-ab36-adad0d7f22f0"/>
              <testAssertions>
                <TestAssertion id="EIDb28b84fb-9734-45a5-a8bb-6db9a7eae858">
                  <label>TestAssertion</label>
                  <description><![CDATA[The property with localName 'handlingDescription' and namespace 'http://www.isotc211.org/2005/gmd' should have a minimum cardinality of 0 and a maximum cardinality of 0]]></description>
                  <parent ref="EID40a36d49-dacc-488a-86fd-f025bcd07108"/>
                  <expectedResult>NOT_APPLICABLE</expectedResult>
                  <expression>let $messages :=
  (for $record in $db
     let $rid := $record//*[local-name()='fileIdentifier' and namespace-uri()='http://www.isotc211.org/2005/gmd']/*/text()
     let $typesFound := $record//*[local-name()='MD_SecurityConstraints' and namespace-uri()='http://www.isotc211.org/2005/gmd']
     for $typeFound in $typesFound 
       let $propertyCount := count($typeFound/*[local-name()='handlingDescription' and namespace-uri()='http://www.isotc211.org/2005/gmd']) 
       return
       if (($propertyCount lt 0) or ($propertyCount gt 0)) then
        local:addMessage('TR.invalidPropertyCardinalityError', map { 'localName': 'MD_SecurityConstraints', 'namespace': 'http://www.isotc211.org/2005/gmd', 'fileIdentifier': $rid, 'filename': local:filename($record), 'invalidCardinality': $propertyCount })
       else ()
  )[position() le $limitErrors]
return
(if ($messages) then 'FAILED' else 'PASSED',
 local:error-statistics('TR.recordsWithErrors', count(fn:distinct-values($messages//etf:argument[@token='id']/text()))),
 $messages)</expression>
                  <testItemType ref="EIDb48eeaa3-6a74-414a-879c-1dc708017e11"/>
                  <translationTemplates>
                    <translationTemplate ref="TR.recordsWithErrors"/>
                    <translationTemplate ref="TR.missingTypeContentError"/>
                    <translationTemplate ref="TR.missingMandatoryTypeError"/>
                    <translationTemplate ref="TR.invalidPropertyCardinalityError"/>
                    <translationTemplate ref="TR.invalidPropertyValueError"/>
                  </translationTemplates>
                </TestAssertion>
              </testAssertions>
            </TestStep>
          </testSteps>
        </TestCase>
      </testCases>
    </TestModule>
    <TestModule id="EID00bfb32f-84d1-4214-aa90-fffa75ddeefe">
      <label>MD_FeatureCatalogueDescription</label>
      <description><![CDATA[This is a test module]]></description>
      <parent ref="EID5d449875-1b39-4e34-8f59-b4d3c4045b06"/>
      <testCases/>
    </TestModule>
    <TestModule id="EID6891204e-537b-4d8c-8d12-66bd9c24ddbf">
      <label>MD_Usage</label>
      <description><![CDATA[This is a test module]]></description>
      <parent ref="EID5d449875-1b39-4e34-8f59-b4d3c4045b06"/>
      <testCases>
        <TestCase id="EID9395ab9f-b4c4-43e1-aac8-5b8f044a02e3">
          <label>ISO-Element Nr. 64: usage­Date­Time</label>
          <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
          <parent ref="EID6891204e-537b-4d8c-8d12-66bd9c24ddbf"/>
          <testSteps>
            <TestStep id="EIDb6fccfe9-005e-420f-8c25-e71c6cc98fce">
              <label>ISO-Element Nr. 64: usage­Date­Time</label>
              <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
              <parent ref="EID9395ab9f-b4c4-43e1-aac8-5b8f044a02e3"/>
              <statementForExecution>not applicable</statementForExecution>
              <testItemType ref="EIDf483e8e8-06b9-4900-ab36-adad0d7f22f0"/>
              <testAssertions>
                <TestAssertion id="EID0cc0144f-b215-485e-a5d7-effc2250e59b">
                  <label>TestAssertion</label>
                  <description><![CDATA[The property with localName 'usageDateTime' and namespace 'http://www.isotc211.org/2005/gmd' should have a minimum cardinality of 0 and a maximum cardinality of 0]]></description>
                  <parent ref="EIDb6fccfe9-005e-420f-8c25-e71c6cc98fce"/>
                  <expectedResult>NOT_APPLICABLE</expectedResult>
                  <expression>let $messages :=
  (for $record in $db
     let $rid := $record//*[local-name()='fileIdentifier' and namespace-uri()='http://www.isotc211.org/2005/gmd']/*/text()
     let $typesFound := $record//*[local-name()='MD_Usage' and namespace-uri()='http://www.isotc211.org/2005/gmd']
     for $typeFound in $typesFound 
       let $propertyCount := count($typeFound/*[local-name()='usageDateTime' and namespace-uri()='http://www.isotc211.org/2005/gmd']) 
       return
       if (($propertyCount lt 0) or ($propertyCount gt 0)) then
        local:addMessage('TR.invalidPropertyCardinalityError', map { 'localName': 'MD_Usage', 'namespace': 'http://www.isotc211.org/2005/gmd', 'fileIdentifier': $rid, 'filename': local:filename($record), 'invalidCardinality': $propertyCount })
       else ()
  )[position() le $limitErrors]
return
(if ($messages) then 'FAILED' else 'PASSED',
 local:error-statistics('TR.recordsWithErrors', count(fn:distinct-values($messages//etf:argument[@token='id']/text()))),
 $messages)</expression>
                  <testItemType ref="EIDb48eeaa3-6a74-414a-879c-1dc708017e11"/>
                  <translationTemplates>
                    <translationTemplate ref="TR.recordsWithErrors"/>
                    <translationTemplate ref="TR.missingTypeContentError"/>
                    <translationTemplate ref="TR.missingMandatoryTypeError"/>
                    <translationTemplate ref="TR.invalidPropertyCardinalityError"/>
                    <translationTemplate ref="TR.invalidPropertyValueError"/>
                  </translationTemplates>
                </TestAssertion>
              </testAssertions>
            </TestStep>
          </testSteps>
        </TestCase>
        <TestCase id="EID727219b1-efa6-4c68-badf-a056fc3439fb">
          <label>ISO-Element Nr. 65: user­Determined­Limitations</label>
          <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
          <parent ref="EID6891204e-537b-4d8c-8d12-66bd9c24ddbf"/>
          <testSteps>
            <TestStep id="EID3693ddf8-3b3f-488a-b0b0-c4dc34284c17">
              <label>ISO-Element Nr. 65: user­Determined­Limitations</label>
              <description><![CDATA[Das Element ist nicht Bestandteil des NRW-Metadatenprofils.]]></description>
              <parent ref="EID727219b1-efa6-4c68-badf-a056fc3439fb"/>
              <statementForExecution>not applicable</statementForExecution>
              <testItemType ref="EIDf483e8e8-06b9-4900-ab36-adad0d7f22f0"/>
              <testAssertions>
                <TestAssertion id="EID51dcf4d3-cd00-4636-861a-214a943d6f4c">
                  <label>TestAssertion</label>
                  <description><![CDATA[The property with localName 'userDeterminedLimitations' and namespace 'http://www.isotc211.org/2005/gmd' should have a minimum cardinality of 0 and a maximum cardinality of 0]]></description>
                  <parent ref="EID3693ddf8-3b3f-488a-b0b0-c4dc34284c17"/>
                  <expectedResult>NOT_APPLICABLE</expectedResult>
                  <expression>let $messages :=
  (for $record in $db
     let $rid := $record//*[local-name()='fileIdentifier' and namespace-uri()='http://www.isotc211.org/2005/gmd']/*/text()
     let $typesFound := $record//*[local-name()='MD_Usage' and namespace-uri()='http://www.isotc211.org/2005/gmd']
     for $typeFound in $typesFound 
       let $propertyCount := count($typeFound/*[local-name()='userDeterminedLimitations' and namespace-uri()='http://www.isotc211.org/2005/gmd']) 
       return
       if (($propertyCount lt 0) or ($propertyCount gt 0)) then
        local:addMessage('TR.invalidPropertyCardinalityError', map { 'localName': 'MD_Usage', 'namespace': 'http://www.isotc211.org/2005/gmd', 'fileIdentifier': $rid, 'filename': local:filename($record), 'invalidCardinality': $propertyCount })
       else ()
  )[position() le $limitErrors]
return
(if ($messages) then 'FAILED' else 'PASSED',
 local:error-statistics('TR.recordsWithErrors', count(fn:distinct-values($messages//etf:argument[@token='id']/text()))),
 $messages)</expression>
                  <testItemType ref="EIDb48eeaa3-6a74-414a-879c-1dc708017e11"/>
                  <translationTemplates>
                    <translationTemplate ref="TR.recordsWithErrors"/>
                    <translationTemplate ref="TR.missingTypeContentError"/>
                    <translationTemplate ref="TR.missingMandatoryTypeError"/>
                    <translationTemplate ref="TR.invalidPropertyCardinalityError"/>
                    <translationTemplate ref="TR.invalidPropertyValueError"/>
                  </translationTemplates>
                </TestAssertion>
              </testAssertions>
            </TestStep>
          </testSteps>
        </TestCase>
      </testCases>
    </TestModule>
  </testModules>
</ExecutableTestSuite>
